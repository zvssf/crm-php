$(document).ready(function(){"use strict";if($("#my-awesome-dropzone").length>0){const e=$("#upload-results-datatable").DataTable({language:{paginate:{previous:"<i class='mdi mdi-chevron-left'>",next:"<i class='mdi mdi-chevron-right'>"},info:"Отображение с _START_ по _END_ из _TOTAL_ файлов.",lengthMenu:"Показывать <select class='form-select form-select-sm ms-1 me-1'><option value='5'>по 5</option><option value='10'>по 10</option><option value='-1'>Все</option></select>",emptyTable:"Результаты загрузки появятся здесь."},pageLength:5,columns:[{orderable:!0},{orderable:!0},{orderable:!0},{orderable:!1}],order:[],drawCallback:function(){$(".dataTables_paginate > .pagination").addClass("pagination-sm"),$("#upload-results-datatable_length label").addClass("form-label"),document.querySelector(".dataTables_wrapper .row").querySelectorAll(".col-md-6").forEach(function(e){e.classList.add("col-sm-6"),e.classList.remove("col-sm-12"),e.classList.remove("col-md-6")})}});new Dropzone("#my-awesome-dropzone",{paramName:"client_pdfs",acceptedFiles:"application/pdf",autoProcessQueue:!0,parallelUploads:5,previewsContainer:!1,init:function(){this.on("addedfile",function(t){const a=e.row.add([t.name,`${(t.size/1024).toFixed(1)} KB`,'<div class="spinner-border spinner-border-sm text-primary" role="status"></div><span class="ms-1">Обработка...</span>',"—"]).draw(!1).node();a.id=`result-${t.upload.uuid}`}),this.on("success",function(e,t){const a=$(`#result-${e.upload.uuid}`);try{var s="string"==typeof t?JSON.parse(t):t;let e,l;"success"===s.status?(e=`<span class="badge badge-success-lighten">Прикреплена к анкете №${s.client_id}</span>`,l="—"):(e=`<span class="badge badge-danger-lighten">Ошибка:</span><div class="font-13 mt-1 text-wrap">${s.message}</div>`,l='<button type="button" class="btn btn-xs btn-secondary">Прикрепить вручную</button>'),a.find("td:eq(2)").html(e),a.find("td:eq(3)").html(l)}catch(e){a.find("td:eq(2)").html('<span class="badge badge-warning-lighten">Ошибка ответа сервера</span>'),a.find("td:eq(3)").html('<button type="button" class="btn btn-xs btn-secondary">Прикрепить вручную</button>')}}),this.on("error",function(e,t){const a=$(`#result-${e.upload.uuid}`);let s="object"==typeof t&&t.error?t.error:t;a.find("td:eq(2)").html(`<span class="badge badge-danger-lighten">Ошибка загрузки:</span><div class="font-13 mt-1 text-wrap">${s}</div>`),a.find("td:eq(3)").html('<button type="button" class="btn btn-xs btn-secondary">Прикрепить вручную</button>')})}})}});